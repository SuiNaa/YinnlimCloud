<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>è³£å®¶ä¸»é </title>
<style>
  :root{ --brand:#6c4ef7; --muted:#777; }
  *{box-sizing:border-box}
  body{ margin:0; font-family: system-ui,-apple-system,"Noto Sans TC",Arial,sans-serif; background:#fafafa; color:#222; }
  .wrap{ max-width:960px; margin:0 auto; padding:20px 14px 40px; }
  .card{ background:#fff; border:1px solid #eee; border-radius:16px; padding:16px; box-shadow:0 8px 20px rgba(0,0,0,.06); }
  .profile{ display:flex; gap:14px; align-items:center; }
  .avatar{ width:88px; height:88px; border-radius:50%; object-fit:cover; background:#f3f3f3; border:1px solid #eee; }
  .name{ font-size:20px; font-weight:800; }
  .muted{ color:var(--muted); font-size:13px; }
  .grid{ display:grid; gap:14px; grid-template-columns:repeat(auto-fill,minmax(160px,1fr)); margin-top:14px;}
  .pcard{ border:1px solid #eee; border-radius:12px; overflow:hidden; background:#fff; box-shadow:0 6px 16px rgba(0,0,0,.06); }
  .pthumb{ width:100%; height:120px; object-fit:cover; background:#f3f3f3; display:block; }
  .pbody{ padding:10px; }
  .ptitle{ font-weight:700; font-size:14px; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; margin-bottom:6px; }
  .pprice{ color:#e91e63; font-weight:800; }
  a.back{ color:var(--brand); text-decoration:none; font-weight:700; display:inline-block; margin:10px 0 6px; }
  /* =========================
   ä¸»é¡Œè®Šæ•¸ï¼ˆèˆ‡è©³æƒ…é ä¸€è‡´ï¼‰
   ========================= */
:root{
  --brand:#6c4ef7;
  --muted:#777;
  --accent:#e91e63;

  /* ç™½å¤©å½ˆåŒ¡ï¼ˆæ·¡ç²‰ï¼‰ */
  --dropdown-bg:#fdeaff;
  --dropdown-border:#f5ccff;
  --dropdown-text:#4a3a6a;
}

html[data-theme="dark"]{
  --text:#cfc3ff;
  --muted:#9a8fd1;
  --brand:#a48cff;
  --accent:#bf66ff;

  --card-bg:#161222;
  --card-border:#2b2440;
  --page-bg:#0f0b1a;

  --btn-bg:#1b1629;
  --btn-border:#2b2440;
  --btn-text:#cfc3ff;

  --chip-bg:#1b1629;
  --chip-border:#2b2440;

  --shadow:0 10px 28px rgba(0,0,0,.45);
}

/* =========================
   åŸºæœ¬è‰²ç³»ï¼ˆå¤œé–“ç¸½é–‹é—œï¼‰
   ========================= */
html[data-theme="dark"] body{ background:var(--page-bg); color:var(--text); }
html[data-theme="dark"] .muted{ color:var(--muted); }
html[data-theme="dark"] .name{ color:var(--text); }

/* å¡ç‰‡/æ¸…å–® */
html[data-theme="dark"] .card,
html[data-theme="dark"] .pcard{
  background:var(--card-bg);
  border:1px solid var(--card-border);
  box-shadow:var(--shadow);
  color:var(--text);
}

/* ç¸®åœ–åº•è‰²ã€é ­è²¼é‚Šæ¡† */
html[data-theme="dark"] .pthumb{ background:#1e1930; }
html[data-theme="dark"] .avatar{ border-color:var(--card-border); }

/* åƒ¹æ ¼é¡è‰²ä¸€è‡´ */
html[data-theme="dark"] .pprice{ color:var(--accent); }

/* è¿”å›é€£çµ */
a.back{ text-decoration:none; }
html[data-theme="dark"] a.back{ color:var(--brand); }

/* åˆ†éš”ç·š */
html[data-theme="dark"] hr{ border-top:1px solid var(--card-border) !important; }

/* =========================
   å³ä¸Šè§’ï¼šåœ“çƒæŒ‰éˆ• & ä¸‹æ‹‰å½ˆåŒ¡
   ========================= */

/* æ”¾ä¸€èµ·å¥½å°é½Š */
.menu-wrap{ position:relative; display:inline-flex; gap:8px; align-items:center; }

/* åœ“çƒæŒ‰éˆ•ï¼ˆå’Œå‰ä¸€é ä¸€è‡´ï¼›å¯è‡ªè¡Œèª¿å¤§å°ï¼‰ */
.menu-btn{
  width:30px; height:30px; border-radius:50%;
  display:flex; align-items:center; justify-content:center;
  font-size:16px; font-weight:700; line-height:1;
  background:var(--brand); color:#fff; border:none;
  cursor:pointer; transition:transform .2s ease, background .2s ease, box-shadow .2s ease;
  box-shadow:0 4px 12px rgba(108,78,247,.22);
}
.menu-btn:hover{ transform:scale(1.08); }
.menu-btn:active{ transform:scale(.96); }

/* å¤œé–“ç‰ˆåœ“çƒ */
html[data-theme="dark"] .menu-btn{
  background:var(--btn-bg);
  border:1px solid var(--btn-border);
  color:var(--btn-text);
  box-shadow:none;
}

/* ä¸‹æ‹‰ï¼šé è¨­é—œé–‰ï¼ˆè²¼è‘—æŒ‰éˆ•æ­£ä¸‹ä¸¦ç•¥å‘å³ï¼‰ */
.dropdown{
  position:absolute;
  left:0; top:calc(100% + 8px);
  transform:translateX(8px) translateY(-6px) scale(.98);
  opacity:0; visibility:hidden; pointer-events:none;
  min-width:220px; max-width:min(320px, 80vw);
  border-radius:14px; padding:8px; z-index:999;
  transition:opacity .16s ease, transform .18s cubic-bezier(.2,.8,.2,1);
  background:var(--dropdown-bg); color:var(--dropdown-text);
  border:1px solid var(--dropdown-border);
  box-shadow:0 16px 32px rgba(0,0,0,.18);
}
/* é¡¯ç¤º */
.dropdown.show{
  transform:translateX(8px) translateY(0) scale(1);
  opacity:1; visibility:visible; pointer-events:auto;
}

/* å°ç®­é ­ç§»é™¤ï¼ˆé¿å…ã€Œçªèµ·ã€ï¼‰ */
.dropdown::after{ content:none; }

/* é¸å–®é …ç›® & æ‡¸æµ®éˆå‹•æ„Ÿ */
.dropdown .item{
  width:100%; text-align:left; padding:10px 12px; border:0;
  background:transparent; color:inherit; border-radius:8px; cursor:pointer;
  transition:transform .12s ease, background .12s ease;
}
.dropdown .item:hover{ transform:translateY(-1px); background:rgba(108,78,247,.10); }

/* å¤œé–“ç‰ˆä¸‹æ‹‰ */
html[data-theme="dark"] .dropdown{
  background:var(--card-bg);
  color:var(--text);
  border:1px solid var(--card-border);
  box-shadow:var(--shadow);
}

/* å°è¢å¹•æ™‚é å·¦é¿å…å‡ºæ¡† */
@media (max-width:560px){
  .dropdown, .dropdown.show{ left:0; transform:translateX(0) translateY(0) scale(1); }
}

/* =========================
   ç´°ç¯€å¾®èª¿
   ========================= */
.wrap{ max-width:960px; margin:0 auto; padding:20px 14px 40px; }
.pcard{ transition:transform .16s ease, box-shadow .16s ease; }
.pcard:hover{ transform:translateY(-2px); box-shadow:0 10px 24px rgba(0,0,0,.10); }
/* èŠå¤©æŒ‰éˆ•å®¹å™¨ */
.seller-actions{ margin-top:10px; display:flex; gap:8px; }

/* ğŸ’¬ èŠå¤©æŒ‰éˆ• */
.chat-btn{
  display:inline-flex; align-items:center; gap:6px;
  padding:8px 12px; border-radius:10px;
  background:var(--brand); color:#fff; font-weight:800;
  border:1px solid transparent; text-decoration:none; cursor:pointer;
  box-shadow:0 6px 16px rgba(108,78,247,.25);
  transition:transform .15s ease, box-shadow .18s ease, background .18s ease;
}
.chat-btn:hover{ transform:translateY(-1px); box-shadow:0 10px 24px rgba(108,78,247,.35); }
.chat-btn:active{ transform:translateY(0); }

/* å¤œé–“ï¼šç”¨æŒ‰éˆ•è®Šæ•¸é¡è‰²ï¼ˆä½ å·²å®šç¾©éï¼‰ */
html[data-theme="dark"] .chat-btn{
  background:var(--brand);
  color:#161222;
  box-shadow:none;
}
/* æª¢èˆ‰æŒ‰éˆ•ï¼ˆç´…ï¼‰ */
.report-btn{
  display:inline-flex; align-items:center; gap:6px;
  padding:8px 12px; border-radius:10px;
  background:#e91e63; color:#fff; font-weight:800;
  border:1px solid transparent; cursor:pointer;
  box-shadow:0 6px 16px rgba(233,30,99,.25);
  transition:transform .15s ease, box-shadow .18s ease, background .18s ease;
}
.report-btn:hover{ transform:translateY(-1px); box-shadow:0 10px 24px rgba(233,30,99,.35); }
.report-btn:active{ transform:translateY(0); }

/* å¤œé–“ä¹Ÿæ¸…æ¥š */
html[data-theme="dark"] .report-btn{ background:#bf3b6e; color:#161222; box-shadow:none; }

/* æª¢èˆ‰å½ˆçª— */
.backdrop{ position:fixed; inset:0; background:rgba(0,0,0,.35);
  display:none; align-items:center; justify-content:center; padding:16px; z-index:3000; }
.modal{
  width:min(640px,92vw); max-height:92vh; overflow:auto;
  background:#fff; border:1px solid #eee; border-radius:14px; box-shadow:0 16px 40px rgba(0,0,0,.22);
}
.modal header{ position:sticky; top:0; background:#fff; padding:12px 14px;
  font-weight:800; border-bottom:1px solid #eee; display:flex; justify-content:space-between; align-items:center; }
.modal .body{ padding:12px 14px; }
.modal .actions{ position:sticky; bottom:0; background:#fff; border-top:1px solid #eee;
  padding:10px 14px; display:flex; gap:10px; justify-content:flex-end; }
.modal .field{ margin:10px 0; }
.modal label{ display:block; font-size:12px; color:#777; margin-bottom:6px; }
.modal .input, .modal .textarea, .modal .file{
  width:100%; padding:10px 12px; border:1px solid #ddd; border-radius:10px; outline:none; background:#fff;
}
.modal .textarea{ min-height:120px; resize:vertical; }
.modal .err{ color:#b00020; font-size:13px; margin-top:4px; }

html[data-theme="dark"] .modal{
  background:var(--card-bg); color:var(--text); border:1px solid var(--card-border); box-shadow:var(--shadow);
}
html[data-theme="dark"] .modal header,
html[data-theme="dark"] .modal .actions{ background:var(--card-bg); border-color:var(--card-border); }
html[data-theme="dark"] .modal .input,
html[data-theme="dark"] .modal .textarea,
html[data-theme="dark"] .modal .file{ 
  background:transparent; 
  color:var(--text); 
  border:1px solid var(--card-border); 
  }
</style>
<style>
    /*æ¸¸æ¨™*/
/* é€æ˜ 1x1 æ¸¸æ¨™ï¼ˆè³‡æ–™URIï¼‰ï¼Œæ¯”å–®ç´” none æ›´ä¸æœƒè¢«ç€è¦½å™¨è‡¨æ™‚è¦†è“‹ */
:root{
  --cursor-none: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAEklEQVQImWNgYGBgYAAAAAQAARV7J8EAAAAASUVORK5CYII=') 0 0, none;
}

/* å¾¹åº•å¥—ç”¨åˆ°æ‰€æœ‰ç›’èˆ‡å½å…ƒç´  */
html, body, *, *::before, *::after{
  cursor: var(--cursor-none) !important;
}

/* ä»»ä½•åŸæœ¬æœƒæŠŠæ¸¸æ¨™æ”¹æˆ pointer / text çš„å…ƒç´ ï¼Œå¼·åˆ¶ç¹¼æ‰¿å°±ä¸æœƒè·³å›åŸç”Ÿæ¨£å¼ */
a, button, [role="button"], label, summary,
input, textarea, select, option, details, svg, canvas{
  cursor: inherit !important;
}

/* ä½ çš„è‡ªè¨‚æ¸¸æ¨™å¤–å±¤ï¼ˆä¸è®Šï¼‰ */
#cursor{
  position: fixed; left:0; top:0; width:0; height:0;
  pointer-events: none; will-change: transform; z-index: 9999;
}
/* å…§å±¤åœ–ç‰‡ï¼ˆä¸è®Šï¼‰ */
#cursor .cursor-img{
  width:32px; height:32px;
  background: url('../love.png') center/contain no-repeat;
  transform: translate(-8px,-12px) scale(1);
  transition: transform .12s ease; 
  will-change: transform;
}
#cursor.down .cursor-img{ 
  transform: translate(-8px,-12px) scale(.9); 
}
/* é€æ˜é®ç½©ï¼šé è¨­ä¸æ“‹äº’å‹•ï¼Œä½†åœ¨æ²å‹•ç¬é–“çŸ­æš«æ¥æ‰‹ hit-test ä»¥ä¿è­‰ cursor:none ç”Ÿæ•ˆ */
#cursor-shield{
  position: fixed;
  inset: 0;
  cursor: var(--cursor-none) !important;  /* ä¸€å¾‹éš±è—ç³»çµ±æ¸¸æ¨™ */
  pointer-events: none;                   /* å¹³å¸¸ä¸æ“‹é»æ“Š/æ»‘å‹• */
  z-index: 9998;                          /* ä½æ–¼è‡ªè¨‚æ¸¸æ¨™ #cursor */
}

/* ã€Œæ²å‹•ä¸­ã€çŸ­æš«å•Ÿç”¨å‘½ä¸­ï¼ˆåªå½±éŸ¿æ¸¸æ¨™å‘½ä¸­ï¼Œä¸æœƒå½±éŸ¿æ»¾å‹•ï¼‰ */
#cursor-shield.cover{
  pointer-events: auto;                   /* è®“å®ƒæˆç‚ºå‘½ä¸­å…ƒç´ ï¼Œæ¸¸æ¨™å°±ä¸æœƒè¢«ä¸‹é¢åŸç”Ÿæ§ä»¶å¥ªå› */
}
</style>
</head>
<body>
<div id="cursor-shield"></div>
<div id="cursor"><div class="cursor-img"></div></div>

  <div class="wrap">
     <div class="menu-wrap">
      <a href="shopping.html" class="back">â†Esc Store</a>
  <button id="menuBtn" class="menu-btn" aria-expanded="false" onclick="toggleMenu()">%</button>
  <div id="menuDrop" class="dropdown" role="menu">
    <!-- ç¬¬ä¸€å€‹é¸é …ï¼šåˆ‡æ›æ¨¡å¼ -->
    <button class="item" onclick="toggleTheme()" id="modeItem">åˆ‡æ›æ¨¡å¼ï¼šå¤œé–“</button>
     <button class="item" onclick="location.href='../index.html'">ä¸»é </button>
    <button class="item" onclick="location.href='Grove.Examination-Yuan.html'">åƒåŠ ç®¡ç†å“¡</button>
    <button class="item" onclick="location.href='Grove. Control-Yuan.html'">Control</button>
    <button class="item" onclick="location.href='Grove.Executive-Yuan.html'">Executive</button>
    <button class="item" onclick="location.href='Grove.Judicial-Yuan.html'">ç”³è¨´</button>
    <button class="item" onclick="location.href='Grove.Legislative-Yuan.html'">Legislative</button>
    <button class="item" onclick="location.href='vote.html'">æŠ•ç¥¨å°ˆå€</button>
    <button class="item" onclick="location.href='constitution.html'">ç¶²ç«™ç”³æ˜</button>
  </div>
</div>
    <div class="card">
  <div class="profile">
    <img id="sAvatar" class="avatar" src="" alt="è³£å®¶é ­è²¼">
    <div>
      <div id="sName" class="name">â€”</div>
      <div id="sGid" class="muted">GIDï¼šâ€”</div>
      <div id="sellerActions" class="seller-actions">ğŸ’¬</div>  <!-- æŒ‰éˆ•æœƒå¡åœ¨é€™ -->
    </div>
  </div>
</div>

    <div class="card" style="margin-top:14px">
      <div style="font-weight:800;margin-bottom:8px">è³£å®¶çš„æ‰€æœ‰å•†å“</div>
      <div id="sProducts" class="grid"></div>
    </div>
  </div>
<!-- æª¢èˆ‰å½ˆçª— -->
<div id="reportDlg" class="backdrop" role="dialog" aria-modal="true" aria-labelledby="rptTitle">
  <div class="modal">
    <header>
      <div id="rptTitle">æª¢èˆ‰æ­¤ç”¨æˆ¶</div>
      <div class="closex" style="cursor:pointer;font-size:20px;color:#888" onclick="closeReport()">Ã—</div>
    </header>
    <div class="body">
      <div class="field">
        <label>è¢«æª¢èˆ‰è€… GID</label>
        <input id="rptGid" class="input" type="text" readonly>
      </div>
      <div class="field">
        <label>æª¢èˆ‰ç†ç”±ï¼ˆå¿…å¡«ï¼‰</label>
        <textarea id="rptReason" class="textarea" placeholder="è«‹è©³è¿°æƒ…æ³ã€æ™‚é–“ã€å°è©±ç¯€éŒ„â€¦"></textarea>
      </div>
      <div class="field">
        <label>åœ–ç‰‡è­‰æ“šï¼ˆå¯é¸ï¼Œæœ€å¤š 1 å¼µï¼‰</label>
        <input id="rptImg" class="file" type="file" accept="image/*">
        <div class="muted">è‹¥æœ‰å°è©±æˆªåœ–ã€è½‰å¸³æ†‘è­‰ç­‰ï¼Œå¯é™„ä¸Šæ›´å¥½ã€‚</div>
      </div>
      <div id="rptErr" class="err"></div>
    </div>
    <div class="actions">
      <button class="btn" onclick="closeReport()">å–æ¶ˆ</button>
      <button class="btn primary" onclick="submitReport()">é€å‡ºæª¢èˆ‰</button>
    </div>
  </div>
</div>
<script>
const API     = "https://zdqo2eqb.lc-cn-n1-shared.com/1.1";
const APP_ID  = "ZDqo2eQBcSChCfRgwix9jUeI-gzGzoHsz";
const APP_KEY = "U66ybZWAD99LrT9zJnQlW52H";
const CURRENCY_SIGN = 'Â¥';
const money = n => Number(n||0).toLocaleString('zh-TW');
// â€¦åŸæœ¬å¸¸æ•¸å¾Œé¢
//ç®¡ç†å“¡
const REPORT_ADMIN_UID = "68b19eeb90ed2201c4839219";
//ç®¡ç†å“¡
/* ä¸Šå‚³åœ–ç‰‡ â†’ LeanCloud /filesï¼Œå›å‚³ URL */
function fileToBase64(file){
  return new Promise((resolve,reject)=>{
    const fr = new FileReader();
    fr.onload = ()=> resolve(fr.result.split(',')[1]);
    fr.onerror = reject;
    fr.readAsDataURL(file);
  });
}
async function uploadOne(file){
  const base64 = await fileToBase64(file);
  const r = await fetch(`${API}/files/${encodeURIComponent(file.name)}`,{
    method:'POST',
    headers:{'Content-Type':'application/json','X-LC-Id':APP_ID,'X-LC-Key':APP_KEY},
    body: JSON.stringify({ base64 })
  });
  const data = await r.json();
  if(!r.ok) throw new Error(data.error || 'æª”æ¡ˆä¸Šå‚³å¤±æ•—');
  return data.url;
}
let __reportTargetUid = "";   // è¢«æª¢èˆ‰è€…
function openReport(targetUid){
  __reportTargetUid = targetUid || "";
  document.getElementById('rptGid').value = __reportTargetUid;
  document.getElementById('rptReason').value = '';
  document.getElementById('rptImg').value = '';
  document.getElementById('rptErr').textContent = '';
  document.getElementById('reportDlg').style.display = 'flex';
}
function closeReport(){
  document.getElementById('reportDlg').style.display = 'none';
}
async function submitReport(){
  const me   = JSON.parse(localStorage.getItem('sg_user')||'null');
  const token= localStorage.getItem('sg_token');
  if(!me || !token){ alert('è«‹å…ˆç™»å…¥å¾Œå†æª¢èˆ‰'); return; }

  const target = __reportTargetUid;
  const reason = (document.getElementById('rptReason').value || '').trim();
  const file   = document.getElementById('rptImg').files[0];
  const errEl  = document.getElementById('rptErr');
  errEl.textContent = '';

  if(!target){ errEl.textContent = 'ç¼ºå°‘è¢«æª¢èˆ‰è€… GID'; return; }
  if(!reason){ errEl.textContent = 'è«‹å¡«å¯«æª¢èˆ‰ç†ç”±'; return; }

  try{
    // å¯é¸åœ–ç‰‡
    let proofUrl = '';
    if(file){ proofUrl = await uploadOne(file); }

    // åªåœ¨ Report é¡åˆ¥å»ºç«‹æ¡ˆä»¶ï¼Œè®“ç›£å¯Ÿé™¢ä¸»é å»è®€å–
    const payload = {
      target:   { "__type":"Pointer","className":"_User","objectId": target },
      targetGid: target,                              // æ–¹ä¾¿æŸ¥è©¢
      reporter: { "__type":"Pointer","className":"_User","objectId": me.objectId },
      reason,
      images: proofUrl ? [proofUrl] : [],
      status: "new",                                  // ç›£å¯Ÿé™¢ä¸»é é¡¯ç¤ºç”¨
      source: "seller",                               // å¾è³£å®¶é é€å‡º
      ACL:{
        "*":               { "read": false },         // ä¸å…¬é–‹
        [me.objectId]:     { "read": true, "write": false },
        "role:Admin":      { "read": true, "write": true }   // âœ… ç›£å¯Ÿé™¢å¯è®€å¯«
      }
    };

    const res = await fetch(`${API}/classes/Report`,{
      method:'POST',
      headers:{
        'Content-Type':'application/json',
        'X-LC-Id': APP_ID,
        'X-LC-Key': APP_KEY,
        'X-LC-Session': token
      },
      body: JSON.stringify(payload)
    });
    const data = await res.json();
    if(!res.ok) throw new Error(data.error || 'é€å‡ºå¤±æ•—');

    closeReport();
    alert('âœ… æª¢èˆ‰å·²å»ºç«‹ï¼Œå°‡ç”±ç›£å¯Ÿé™¢è™•ç†ã€‚');
  }catch(e){
    errEl.textContent = e.message || 'é€å‡ºå¤±æ•—';
  }
}
function q(k){ return new URLSearchParams(location.search).get(k); }
function displayPrice(p){
  if(p.samePrice && typeof p.price === 'number') return p.price;
  if(Array.isArray(p.variants) && p.variants.length && typeof p.variants[0].price === 'number') return p.variants[0].price;
  return 0;
}

async function fetchUser(uid){
  const headers = { 'X-LC-Id': APP_ID, 'X-LC-Key': APP_KEY };
  // è‹¥ä½¿ç”¨è€…å·²ç™»å…¥ï¼Œå¤¾å¸¶ Session å¯é¿é–‹æŸäº› ACL é™åˆ¶
  const token = localStorage.getItem('sg_token');
  if(token) headers['X-LC-Session'] = token;

  const where = encodeURIComponent(JSON.stringify({ objectId: uid }));
  const res = await fetch(`${API}/users?where=${where}&limit=1`, { headers });
  const data = await res.json();
  if(!res.ok || !data.results || !data.results.length){
    throw new Error('æ‰¾ä¸åˆ°æ­¤è³£å®¶');
  }
  return data.results[0];
}

async function fetchProductsBySeller(uid){
  const where = encodeURIComponent(JSON.stringify({
    seller: { "__type":"Pointer","className":"_User","objectId": uid }
  }));
  const res = await fetch(`${API}/classes/Product?where=${where}&order=-createdAt`, {
    headers:{ 'X-LC-Id': APP_ID, 'X-LC-Key': APP_KEY }
  });
  const data = await res.json();
  if(!res.ok) throw new Error(data.error || 'å•†å“è®€å–å¤±æ•—');
  return data.results || [];
}
function renderSeller(u){
  const raw = u.avatarUrl || '';
  const avatar = raw ? raw.replace(/^http:\/\//, 'https://')
                     : 'data:image/svg+xml;utf8,'+encodeURIComponent(
                         `<svg xmlns="http://www.w3.org/2000/svg" width="88" height="88">
                            <rect width="100%" height="100%" rx="44" ry="44" fill="#f3f3f3"/>
                            <text x="50%" y="55%" text-anchor="middle" font-size="32">ğŸ™‚</text>
                          </svg>`
                       );
  document.getElementById('sAvatar').src = avatar;
  document.getElementById('sAvatar').alt = `${u.nickname || u.username || 'è³£å®¶'} çš„é ­è²¼`;
  document.getElementById('sName').textContent = u.nickname || u.username || 'â€”';
  document.getElementById('sGid').textContent  = `GIDï¼š${u.objectId || ''}`;

  const me = JSON.parse(localStorage.getItem('sg_user')||'null');
  const box = document.getElementById('sellerActions');
  if (!box) return;

  if (me && me.objectId === u.objectId) {
    box.innerHTML = '';   // è‡ªå·±çœ‹è‡ªå·±ï¼Œä¸é¡¯ç¤ºæŒ‰éˆ•
    return;
  }

  const toHref = `messages.html?to=${encodeURIComponent(u.objectId)}&name=${encodeURIComponent(u.nickname||u.username||'')}&avatar=${encodeURIComponent(u.avatarUrl||'')}`;

  box.innerHTML = `
    <a class="chat-btn" href="${toHref}" title="å’Œå¥¹èŠå¤©">ğŸ’¬ é–‹èŠ</a>
    <button class="report-btn" type="button" onclick="openReport('${u.objectId}')">âš ï¸æª¢èˆ‰</button>
  `;
}
// å¦‚æœç•¶å‰é é¢å°±æ˜¯ messages.htmlï¼Œå¯è®€å– auto=1 è‡ªå‹•é–‹å•Ÿ
// å»ºç«‹(æˆ–å–å¾—)èˆ‡å°æ–¹çš„æœƒè©±ï¼Œå†è·³åˆ° messages.html
let _chatStarting = false;

function renderProducts(list){
  const box = document.getElementById('sProducts');
  box.innerHTML = '';
  if(!list.length){
    box.innerHTML = '<div class="muted">å°šæœªç™¼ä½ˆä»»ä½•å•†å“</div>';
    return;
  }
  for(const p of list){
    const img = p.imageUrl || (p.images && p.images[0]) || 'https://via.placeholder.com/320x240?text=%F0%9F%8C%9E';
    const price = displayPrice(p);
    const card = document.createElement('div');
    card.className = 'pcard';
    card.innerHTML = `
      <img class="pthumb" src="${img}" alt="">
      <div class="pbody">
        <div class="ptitle" title="${p.title || ''}">${p.title || 'æœªå‘½åå•†å“'}</div>
        <div class="pprice">${CURRENCY_SIGN}${money(price)}</div>
      </div>
    `;
    card.onclick = ()=> location.href = `shuser.html?id=${p.objectId}`;
    box.appendChild(card);
  }
}

(async ()=>{
  // âœ… é€™è£¡æ”¹äº†ï¼šåŒæ™‚æ¥å— uid æˆ– id
  // åŒæ™‚æ”¯æ´ ?uid= èˆ‡ ?id=ï¼ˆå‰é å¯èƒ½å‚³ idï¼‰
const uid = q('uid') || q('id');
if(!uid){
  alert('ç¼ºå°‘è³£å®¶ uid');
  // ä¸ä¸­æ–·æ•´é ï¼Œåƒ…é¡¯ç¤ºç©ºè³‡æ–™
  document.getElementById('sName').textContent = 'â€”';
  document.getElementById('sGid').textContent  = 'GIDï¼šâ€”';
  document.getElementById('sProducts').innerHTML = '<div class="muted">å°šæœªè¼‰å…¥è³£å®¶</div>';
  return;
}

  try{
    const u = await fetchUser(uid);
    renderSeller(u);

    const me = JSON.parse(localStorage.getItem('sg_user')||'null');
    if(me && me.objectId === uid){
      // å¦‚æœæœ¬äººé€²ä¾†ï¼Œå¯ç›´æ¥å°å» user.html
      // location.replace('user.html'); return;
    }

    const items = await fetchProductsBySeller(uid);
    renderProducts(items);
  }catch(e){
    alert(e.message || 'è®€å–å¤±æ•—');
  }
})();

</script>
<script src="im.js"></script>
<script src="lioc.js?v=0.1.1"></script>
<!--=================-->
<p style="text-align: center; font-size: 13px; color: #999; margin-top: 40px;">
  ğŸ¾ Â© 2024 yinnlimçš„å°å®‡å®™ï½œå…§å®¹èˆ‡è¨­è¨ˆçš†ç”±ç³–ç³–æœ¬äººç”¨æ„›è£½ä½œ ğŸ’<br>
  æœªç¶“æˆæ¬Šè«‹å‹¿éš¨æ„ä½¿ç”¨ã€ç›œè½‰å–” ğŸ™…â€â™€ï¸ è¬è¬ä½ çš„å°Šé‡èˆ‡æº«æŸ” ğŸ’Œ
</p>
</body>
</html>