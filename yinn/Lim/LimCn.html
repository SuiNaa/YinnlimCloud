<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <title>曦花林</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="Lim.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/leancloud-storage/dist/av-min.js"></script>
   <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+TC&display=swap" rel="stylesheet">
 <link href="https://fonts.googleapis.com/css2?family=Caveat&display=swap" rel="stylesheet">
</head>
<body>

<div id="connectionStatus">
  <span>🍡 糖糖加載中...</span>
  <span class="mac-spinner"></span>
</div>

<div id="currentUserBox" style="margin: 10px 10px 0 10px; font-weight: bold; color: #663399;">
  <span id="currentNickname">帳戶：暱稱加載中...</span>
  <button class="edit-btn" onclick="goToNicknameSettings()" title="修改暱稱">
    ⌘
  </button>
  <button class="logout-btn" onclick="goToLogin()">🍓登入</button>
  <button class="logout-btn" onclick="logout()">🍃登出</button>
  <button class="logout-btn" onclick="confirmDeleteAccount()">🪺 註銷帳戶</button>
</div>
<!--註銷-->
<!-- 🪺 註銷帳戶彈出視窗 -->
<div id="deleteAccountModal" class="modal-overlay" style="display: none;">
  <div class="modal-box">
    <p style="font-size: 18px; font-weight: bold;">您確定要註銷帳戶嗎？</p>
    <p style="margin-top: 8px;">這將會 <strong style="color: red;">永久刪除帳號資料</strong>，無法復原。</p>
    <div style="margin-top: 16px; text-align: right;">
      <button onclick="cancelDeleteAccount()" style="margin-right: 12px;">取消</button>
      <button onclick="confirmDeleteAccount()" style="background-color: #e06666; color: white; border: none; padding: 6px 12px; border-radius: 6px;">✅ 確認註銷</button>
    </div>
  </div>
</div>
 <!-- 🔘 漂浮區塊容器 -->
<div class="info-container">
  <div class="info-toggle" onclick="toggleInfoBox(this)">∞•</div>

  <div class="info-box" id="infoBox">
    曦花林 LimTown<br>
    匯聚自由聲音 友善性別多樣<br>
    傳遞溫柔力量 支持每種存在<br>
    張貼招募訊息 發表公開話語<br>
    打造安心社群 願你自在閃耀<br>
    共建幸福世界
  </div>
</div>
<div class="container">
  <h1>曦花林</h1>
  <h2>Lim Town</h2>

  <div id="messages"></div>
 <!-- 🌈 背景模糊層 -->
<!-- ✅ 不需要外層 form-overlay -->
<div id="postForm" class="form-box">
  <div class="form-row">
    <input type="text" id="title" placeholder="標題" class="form-half">
  </div>
  <textarea id="content" placeholder="請輸入您要發佈的內容..." class="form-full"></textarea>
  <input type="file" id="imageUpload" class="form-full image-upload" accept="image/*">

  <!-- 圖片上下選項 -->
  <div class="image-position-options" style="margin-top: 10px;">
    <label>
      <input type="radio" name="imagePosition" value="top" checked> 📌 圖片在上
    </label>
    <label style="margin-left: 10px;">
      <input type="radio" name="imagePosition" value="bottom"> 📄 圖片在下
    </label>
  </div>

  <br>
  <button id="submitBtn">發佈</button>
</div>
<!--發文-->

<button class="plus-btn" id="plusBtn">🍭</button>

<div id="postsContainer" class="grid-container"></div>

<!-- 🧁 單篇貼文詳情區塊（預設隱藏） -->
<div id="postDetailView" style="display: none; padding: 30px; max-width: 800px; margin: auto;">
  <!-- JS 會動態填入內容 -->
</div>

 <!-- 🌸 漢堡按鈕 -->
<div class="menu-toggle" onclick="toggleMenu()">
  <span></span>
  <span></span>
  <span></span>
</div>

<!-- 🌸 側邊透明選單 -->
<nav class="side-menu" id="sideMenu">
  <ul>
    <div class="hamburger-user-block">
  <div class="nickname-flex">
    <div class="nickname-label">
      <span class="yinn">Yinn</span>
      <span class="town">Town</span>
    </div>
    <div id="yinnNicknameStatus" class="nickname-status">：載入中...</div>
  </div>
</div>

    <li><a href="../index.html">首頁Home page</a></li>
    <li>
      <a href="javascript:void(0);" onclick="showTownLoginModal()"><span class="lim-town-label">
        <span class="lim">Yinn</span>
        <span class="town">Lim</span>
      </span>🍓 登入／註冊<sup>Town</sup></a></li>
      <a href="/Diverse/misseng.html"><span class="lim-town-label">
      <span class="lim">Yinn</span>
      <span class="town">Town</span>
    </span>
   曦花林<sup>NEW</sup>
  </a>
</li>
    <li>
  <a href="/Lim/LimCn.html"><span class="lim-town-label">
      <span class="lim">Lim</span>
      <span class="town">Town</span>
    </span>
    曦花林<sup>NEW</sup>
  </a>
</li>
    <li><a href="/Help.yinnlim/help.html">Grove Hub<sup>💖</sup></a></li>
    <li><a href="/live/shopping.html">Grove Store</a></li>
    <li><a href="/live/constitution.html">網站申明</a></li>
    <li><a href="../About thisn site.html">責任申明</a></li>
     <li><a href="/yinnlim store/AfterSS.html">售後服務</a></li>
     <li><a href="Emoticon pack.html">可愛表情</a></li>
  </ul>
</nav>
  <!-- 放在 <body> 裡 -->
<div id="loader" style="
  display:none;
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  font-size: 32px;
  animation: spin 1s linear infinite;
">🍡</div>
<!---->
<!-- 🧁 修改暱稱浮匡 -->
<div id="nicknameModal" class="modal-overlay" style="display: none;">
  <div class="modal-box">
    <p style="margin-bottom: 10px;">請輸入新的暱稱 ✏️</p>
    <input type="text" id="newNickname" placeholder="新的暱稱" style="width: 100%; padding: 8px;">
    <div style="text-align: right; margin-top: 12px;">
      <button onclick="hideNicknameModal()">取消</button>
      <button onclick="submitNickname()" style="margin-left: 10px;">✅ 確定</button>
    </div>
  </div>
</div>
<!--底註版權-->
<p style="text-align: center; font-size: 13px; color: #999; margin-top: 40px;">
  🐾 © 2024 yinnlim的小宇宙｜內容與設計皆由糖糖本人用愛製作 💞<br>
  未經授權請勿隨意使用、盜轉喔 🙅‍♀️ 謝謝你的尊重與溫柔 💌
</p>
<script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-auth-compat.js"></script>
<script src="Lim.js"></script>
<!-- 🌈 登入選單彈窗 -->

<div id="townLoginModal"
  style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 9999; justify-content: center; align-items: center;">
  <div style="background: linear-gradient(135deg, #5BCEFA, #F5A9B8, #FFFFFF, #F5A9B8, #5BCEFA); padding: 20px; border-radius: 12px; text-align: center; max-width: 300px; width: 90%;">
    <h2 style="margin-bottom: 16px; color: #663399;">請選擇登入的 Town</h2>
    <button onclick="location.href='/Diverse/login.html'" style="margin: 10px; padding: 10px 20px; border-radius: 10px; border: none; background: white; color: #5BCEFA; font-weight: bold;">Yinn Town</button>
    <button onclick="location.href='/Lim/limlongin/login.html'" style="margin: 10px; padding: 10px 20px; border-radius: 10px; border: none; background: white; color: #F5A9B8; font-weight: bold;">Lim Town</button>
    <br><br>
    <button onclick="hideTownLoginModal()" style="margin-top: 10px; font-size: 14px; background: none; border: none; color: #fff; text-decoration: underline;">取消</button>
  </div>
</div>

</body>
</html>